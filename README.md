# ESFSM - –†–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥ (Work Order Report)

–ü—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω PDF –∏–∑–≤–µ—à—Ç–∞—ò –∑–∞ —Ç–µ—Ä–µ–Ω—Å–∫–∏ —Ä–∞–±–æ—Ç–∏.

## –û–ø–∏—Å

–û–≤–æ—ò –º–æ–¥—É–ª –¥–æ–¥–∞–≤–∞ "–†–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥" - –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω QWeb PDF –∏–∑–≤–µ—à—Ç–∞—ò –∑–∞ —Ç–µ—Ä–µ–Ω—Å–∫–∏—Ç–µ —Ä–∞–±–æ—Ç–∏ –≤–æ ESFSM —Å–∏—Å—Ç–µ–º–æ—Ç. –†–∞–±–æ—Ç–Ω–∏–æ—Ç –Ω–∞–ª–æ–≥ –µ –∫–æ–º–ø–ª–µ—Ç–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç –∫–æ—ò –≥–∏ —Å–æ–¥—Ä–∂–∏ —Å–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –∑–∞ —Ä–∞–±–æ—Ç–∞—Ç–∞, –∫–æ—Ä–∏—Å—Ç–µ–Ω–∏—Ç–µ –º–∞—Ç–µ—Ä–∏—ò–∞–ª–∏, –ø–æ—Ç—Ä–æ—à–µ–Ω–∏—Ç–µ —á–∞—Å–æ–≤–∏, —á–µ–∫–ª–∏—Å—Ç–∏ –∏ –ø–æ—Ç–ø–∏—Å–∏ –æ–¥ —Ç–µ—Ö–Ω–∏—á–∞—Ä –∏ –∫–ª–∏–µ–Ω—Ç.

## –ì–ª–∞–≤–Ω–∏ –ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### üìÑ –ü—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω PDF –ò–∑–≤–µ—à—Ç–∞—ò
- **–ö–æ–º–ø–ª–µ—Ç–µ–Ω —Ä–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥**: –°–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –Ω–∞ –µ–¥–Ω–∞ —Å—Ç—Ä–∞–Ω–∞
- **–ö–æ–º–ø–∞–Ω–∏—Å–∫–æ –±—Ä–µ–Ω–¥–∏—Ä–∞—ö–µ**: –õ–æ–≥–æ, –∫–æ–Ω—Ç–∞–∫—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- **–ú–∞–∫–µ–¥–æ–Ω—Å–∫–∏ —ò–∞–∑–∏–∫**: –¶–µ–ª–æ—Å–Ω–æ –Ω–∞ –º–∞–∫–µ–¥–æ–Ω—Å–∫–∏
- **–ü–µ—á–∞—Ç–µ—ö–µ –∏ –µ-–ø–æ—à—Ç–∞**: –î–∏—Ä–µ–∫—Ç–Ω–æ –ø–µ—á–∞—Ç–µ—ö–µ –∏–ª–∏ –∏—Å–ø—Ä–∞—ú–∞—ö–µ –∫–∞–∫–æ –ø—Ä–∏–ª–æ–≥

### üìã –°–æ–¥—Ä–∂–∏–Ω–∞ –Ω–∞ –∏–∑–≤–µ—à—Ç–∞—ò–æ—Ç

**1. Header —Å–µ–∫—Ü–∏—ò–∞:**
- –õ–æ–≥–æ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—ò–∞—Ç–∞
- –ù–∞—Å–ª–æ–≤: "–†–ê–ë–û–¢–ï–ù –ù–ê–õ–û–ì"
- –ö–æ–Ω—Ç–∞–∫—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**2. –û—Å–Ω–æ–≤–Ω–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:**
- –ë—Ä–æ—ò –Ω–∞ —Ä–∞–±–æ—Ç–∞ (FSM-XXXX)
- –î–∞—Ç—É–º –Ω–∞ –∫—Ä–µ–∏—Ä–∞—ö–µ
- –°—Ç–∞—Ç—É—Å/–µ—Ç–∞–ø–∞
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- –¢–∏–ø –Ω–∞ —Ä–∞–±–æ—Ç–∞

**3. –ö–ª–∏–µ–Ω—Ç –∏ –ª–æ–∫–∞—Ü–∏—ò–∞:**
- –ò–º–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç, —Ç–µ–ª–µ—Ñ–æ–Ω, –µ-–ø–æ—à—Ç–∞
- –ê–¥—Ä–µ—Å–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç
- –õ–æ–∫–∞—Ü–∏—ò–∞ –Ω–∞ —Å–µ—Ä–≤–∏—Å–∏—Ä–∞—ö–µ

**4. –¢–µ—Ö–Ω–∏—á–∞—Ä/–¢–∏–º:**
- –ù–∞–∑–Ω–∞—á–µ–Ω —Ç–µ—Ö–Ω–∏—á–∞—Ä –∏–ª–∏ —Ç–∏–º
- –ú–æ–±–∏–ª–µ–Ω —Ç–µ–ª–µ—Ñ–æ–Ω
- –ß–ª–µ–Ω–æ–≤–∏ –Ω–∞ —Ç–∏–º–æ—Ç (–∞–∫–æ –µ —Ç–∏–º)
- –ü–ª–∞–Ω–∏—Ä–∞–Ω–æ vs. –≤–∫—É–ø–Ω–æ —Ç—Ä–∞–µ—ö–µ

**5. –û–ø–∏—Å –Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç–∞:**
- –î–µ—Ç–∞–ª–µ–Ω –æ–ø–∏—Å
- –ó–∞–±–µ–ª–µ—à–∫–∏

**6. Checklist** (–∞–∫–æ –ø–æ—Å—Ç–æ–∏):
- –¢–∞–±–µ–ª–∞ —Å–æ –∑–∞–¥–∞—á–∏
- –°—Ç–∞—Ç—É—Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ (‚úì/‚òê)
- –ü—Ä–æ–≥—Ä–µ—Å –±–∞—Ä
- –ó–∞–±–µ–ª–µ—à–∫–∏ –ø–æ –∑–∞–¥–∞—á–∞

**7. –ú–∞—Ç–µ—Ä–∏—ò–∞–ª–∏** (–∞–∫–æ –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω esfsm_stock):
- –ó–µ–º–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- –ò—Å–∫–æ—Ä–∏—Å—Ç–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- –í—Ä–∞—Ç–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- –ï–¥–∏–Ω–∏—á–Ω–∞ –º–µ—Ä–∞
- –¶–µ–Ω–∞ –∏ –≤–∫—É–ø–µ–Ω –∏–∑–Ω–æ—Å

**8. –í—Ä–µ–º–∏—ö–∞** (–∞–∫–æ –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω esfsm_timesheet):
- –î–∞—Ç—É–º
- –í—Ä–∞–±–æ—Ç–µ–Ω
- –û–ø–∏—Å
- –ß–∞—Å–æ–≤–∏ (float_time —Ñ–æ—Ä–º–∞—Ç)
- –í–∫—É–ø–Ω–æ —á–∞—Å–æ–≤–∏

**9. –ü–æ—Ç–ø–∏—Å–∏:**
- –ü–æ—Ç–ø–∏—Å –Ω–∞ —Ç–µ—Ö–Ω–∏—á–∞—Ä + –¥–∞—Ç—É–º
- –ü–æ—Ç–ø–∏—Å –Ω–∞ –∫–ª–∏–µ–Ω—Ç + –¥–∞—Ç—É–º

**10. Footer:**
- –ê–≤—Ç–æ–º–∞—Ç—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω —Ç–µ–∫—Å—Ç
- –ö–æ–Ω—Ç–∞–∫—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

## –¢–µ—Ö–Ω–∏—á–∫–∏ –î–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–Ω–æ—Å—Ç–∏
- `esfsm` (–∑–∞–¥–æ–ª–∂–∏—Ç–µ–ª–Ω–æ) - Core FSM –º–æ–¥—É–ª

### –û–ø—Ü–∏–æ–Ω–∞–ª–Ω–∏ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- `esfsm_stock` - –ü—Ä–∏–∫–∞–∂—É–≤–∞ –∫–æ—Ä–∏—Å—Ç–µ–Ω–∏ –º–∞—Ç–µ—Ä–∏—ò–∞–ª–∏
- `esfsm_timesheet` - –ü—Ä–∏–∫–∞–∂—É–≤–∞ –≤—Ä–µ–º–∏—ö–∞

### –î–æ–¥–∞–¥–µ–Ω–∏ –ú–µ—Ç–æ–¥–∏ –Ω–∞ `esfsm.job`

#### `action_print_work_order()`
–û—Ç–≤–æ—Ä–∞ –¥–∏—ò–∞–ª–æ–≥ –∑–∞ –ø–µ—á–∞—Ç–µ—ö–µ –Ω–∞ —Ä–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥.

```python
job.action_print_work_order()
```

#### `_has_stock_module()`
–ü—Ä–æ–≤–µ—Ä—É–≤–∞ –¥–∞–ª–∏ –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω esfsm_stock –º–æ–¥—É–ª.

```python
if job._has_stock_module():
    # –ü—Ä–∏–∫–∞–∂–∏ –º–∞—Ç–µ—Ä–∏—ò–∞–ª–∏
```

#### `_has_timesheet_module()`
–ü—Ä–æ–≤–µ—Ä—É–≤–∞ –¥–∞–ª–∏ –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω esfsm_timesheet –º–æ–¥—É–ª.

```python
if job._has_timesheet_module():
    # –ü—Ä–∏–∫–∞–∂–∏ –≤—Ä–µ–º–∏—ö–∞
```

#### `_get_duration_display()`
–§–æ—Ä–º–∞—Ç–∏—Ä–∞ —Ç—Ä–∞–µ—ö–µ –∑–∞ –ø—Ä–∏–∫–∞–∑ (–ø—Ä. "3—á 30–º–∏–Ω").

```python
duration = job._get_duration_display()
# Output: "3—á 30–º–∏–Ω"
```

#### `_get_scheduled_duration_display()`
–§–æ—Ä–º–∞—Ç–∏—Ä–∞ –ø–ª–∞–Ω–∏—Ä–∞–Ω–æ —Ç—Ä–∞–µ—ö–µ –∑–∞ –ø—Ä–∏–∫–∞–∑.

```python
scheduled = job._get_scheduled_duration_display()
# Output: "4—á"
```

## –ò–Ω—Å—Ç–∞–ª–∞—Ü–∏—ò–∞

### –†–∞–∑–≤–æ—ò–Ω–∞ –û–∫–æ–ª–∏–Ω–∞

```bash
# –ê–∫—Ç–∏–≤–∏—Ä–∞—ò dev mode
./odoo-bin --dev=all -d your_database -u esfsm_report

# –ò–ª–∏ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞—ò –Ω–æ–≤ –º–æ–¥—É–ª
./odoo-bin -d your_database -i esfsm_report --stop-after-init
```

### Docker (Production)

```bash
# –ê–∂—É—Ä–∏—Ä–∞—ò –ª–∏—Å—Ç–∞ –Ω–∞ –º–æ–¥—É–ª–∏
docker exec -i odoo_server odoo shell -d eskon --no-http << 'EOF'
env['ir.module.module'].update_list()
env.cr.commit()
EOF

# –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞—ò –º–æ–¥—É–ª
docker exec -i odoo_server odoo shell -d eskon --no-http << 'EOF'
module = env['ir.module.module'].search([('name', '=', 'esfsm_report')])
if module.state == 'uninstalled':
    module.button_immediate_install()
    env.cr.commit()
    print("–ú–æ–¥—É–ª–æ—Ç –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω!")
EOF

# –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞—ò Odoo
docker restart odoo_server
```

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏ —Å—Ç–∞—Ç—É—Å –Ω–∞ –º–æ–¥—É–ª
docker exec -i odoo_server odoo shell -d eskon --no-http << 'EOF'
module = env['ir.module.module'].search([('name', '=', 'esfsm_report')])
print(f"–ú–æ–¥—É–ª: {module.name}, –°–æ—Å—Ç–æ—ò–±–∞: {module.state}")
EOF
```

## –ö–æ—Ä–∏—Å—Ç–µ—ö–µ

### –ü–µ—á–∞—Ç–µ—ö–µ –Ω–∞ –†–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥

#### –ú–µ—Ç–æ–¥ 1: –û–¥ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç–∞

1. –û—Ç–≤–æ—Ä–µ—Ç–µ —Ä–∞–±–æ—Ç–∞
2. –ö–ª–∏–∫–Ω–µ—Ç–µ –Ω–∞ –∫–æ–ø—á–µ—Ç–æ **"–ü–µ—á–∞—Ç–∏ –†–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥"** –≤–æ header
3. PDF —ú–µ —Å–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞ –∏ –æ—Ç–≤–æ—Ä–∏ –≤–æ –Ω–æ–≤–∞ —Ç–∞–±–ª–∞

#### –ú–µ—Ç–æ–¥ 2: –û–¥ Print –º–µ–Ω–∏—Ç–æ

1. –û—Ç–≤–æ—Ä–µ—Ç–µ —Ä–∞–±–æ—Ç–∞
2. –ö–ª–∏–∫–Ω–µ—Ç–µ –Ω–∞ **Print**
3. –ò–∑–±–µ—Ä–µ—Ç–µ **"–†–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥"**

#### –ú–µ—Ç–æ–¥ 3: –ü—Ä–æ–≥—Ä–∞–º—Å–∫–∏

```python
# –ì–µ–Ω–µ—Ä–∏—Ä–∞—ò —Ä–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥ –∑–∞ —Ä–∞–±–æ—Ç–∞
job = env['esfsm.job'].browse(123)
action = job.action_print_work_order()
```

### –ò—Å–ø—Ä–∞—ú–∞—ö–µ –ø–æ –ï-–ø–æ—à—Ç–∞

1. –û—Ç–≤–æ—Ä–µ—Ç–µ —Ä–∞–±–æ—Ç–∞
2. –ö–ª–∏–∫–Ω–µ—Ç–µ –Ω–∞ **Send by Email**
3. "–†–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥" —ú–µ –±–∏–¥–µ –∞–≤—Ç–æ–º–∞—Ç—Å–∫–∏ –ø—Ä–∏–∫–∞—á–µ–Ω –∫–∞–∫–æ PDF

### Bulk –ü–µ—á–∞—Ç–µ—ö–µ

```python
# –ü–µ—á–∞—Ç–∏ –ø–æ–≤–µ—ú–µ —Ä–∞–±–æ—Ç–Ω–∏ –Ω–∞–ª–æ–∑–∏ –æ–¥–µ–¥–Ω–∞—à
jobs = env['esfsm.job'].search([('stage_id.done', '=', True)])
report = env.ref('esfsm_report.action_report_esfsm_work_order')
report.report_action(jobs)
```

## –ü—Ä–∏–º–µ—Ä–∏

### –ì–µ–Ω–µ—Ä–∏—Ä–∞—ö–µ –Ω–∞ PDF

```python
# –ü—Ä–æ–Ω–∞—ò–¥–∏ —Ä–∞–±–æ—Ç–∞
job = env['esfsm.job'].search([('name', '=', 'FSM-001')], limit=1)

# –ì–µ–Ω–µ—Ä–∏—Ä–∞—ò PDF
report = env.ref('esfsm_report.action_report_esfsm_work_order')
pdf_content, file_type = report._render_qweb_pdf([job.id])

# –ó–∞—á—É–≤–∞—ò PDF
import base64
attachment = env['ir.attachment'].create({
    'name': f'–†–∞–±–æ—Ç–µ–Ω –Ω–∞–ª–æ–≥ - {job.name}.pdf',
    'type': 'binary',
    'datas': base64.b64encode(pdf_content),
    'res_model': 'esfsm.job',
    'res_id': job.id,
    'mimetype': 'application/pdf',
})
```

### –ü—Ä–∏–∫–∞–∂–∏ HTML –í–µ—Ä–∑–∏—ò–∞ (–∑–∞ –¥–µ–±–∞–≥)

```python
# –ì–µ–Ω–µ—Ä–∏—Ä–∞—ò HTML –≤–µ—Ä–∑–∏—ò–∞ –Ω–∞ –∏–∑–≤–µ—à—Ç–∞—ò–æ—Ç
job = env['esfsm.job'].browse(123)
report = env.ref('esfsm_report.action_report_esfsm_work_order')
html_content = report._render_qweb_html([job.id])[0]

# –ó–∞—á—É–≤–∞—ò –≤–æ —Ñ–∞—ò–ª –∑–∞ –ø—Ä–µ–≥–ª–µ–¥
with open('/tmp/work_order.html', 'wb') as f:
    f.write(html_content)
```

### –ú–∞—Å–æ–≤–Ω–æ –ü–µ—á–∞—Ç–µ—ö–µ —Å–æ –§–∏–ª—Ç—Ä–∏

```python
# –ü–µ—á–∞—Ç–∏ —Å–∏—Ç–µ –∑–∞–≤—Ä—à–µ–Ω–∏ —Ä–∞–±–æ—Ç–∏ –æ–¥ –æ–≤–æ—ò –º–µ—Å–µ—Ü
from datetime import datetime, timedelta

start_of_month = datetime.now().replace(day=1)
jobs = env['esfsm.job'].search([
    ('date_end', '>=', start_of_month),
    ('stage_id.done', '=', True),
])

print(f"–ì–µ–Ω–µ—Ä–∏—Ä–∞–º {len(jobs)} —Ä–∞–±–æ—Ç–Ω–∏ –Ω–∞–ª–æ–∑–∏...")
report = env.ref('esfsm_report.action_report_esfsm_work_order')
pdf_content = report._render_qweb_pdf(jobs.ids)[0]

# –ó–∞—á—É–≤–∞—ò –∫–∞–∫–æ –µ–¥–µ–Ω PDF
with open('/tmp/monthly_reports.pdf', 'wb') as f:
    f.write(pdf_content)
```

## –¢–µ—Å—Ç–∏—Ä–∞—ö–µ

–ú–æ–¥—É–ª–æ—Ç –≤–∫–ª—É—á—É–≤–∞ 12 –∫–æ–º–ø–ª–µ—Ç–Ω–∏ —Ç–µ—Å—Ç-—Å–ª—É—á–∞–µ–≤–∏:

```bash
# –í—Ä—Ç–∏ —Å–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤–∏
./odoo-bin -d test_db --test-enable --test-tags=/esfsm_report --stop-after-init

# –í—Ä—Ç–∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ–Ω —Ç–µ—Å—Ç
./odoo-bin -d test_db --test-enable \
  --test-tags=/esfsm_report.TestEsfsmReport.test_03_report_rendering_basic
```

### –¢–µ—Å—Ç –ü–æ–∫—Ä–∏–µ–Ω–æ—Å—Ç

- ‚úÖ –ü–æ—Å—Ç–æ–µ—ö–µ –Ω–∞ report action
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä–∞—ö–µ –Ω–∞ PDF
- ‚úÖ Rendering —Å–æ checklist
- ‚úÖ Rendering —Å–æ —Ç–∏–º (–Ω–∞–º–µ—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–∞—Ä)
- ‚úÖ Rendering —Å–æ –ø–æ—Ç–ø–∏—Å–∏
- ‚úÖ Rendering —Å–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∏
- ‚úÖ Multi-company –ø–æ–¥–¥—Ä—à–∫–∞
- ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª–Ω–∏ –º–æ–¥—É–ª–∏ (stock, timesheet)
- ‚úÖ Duration formatting
- ‚úÖ Filename –≥–µ–Ω–µ—Ä–∏—Ä–∞—ö–µ

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### QWeb Template –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```xml
<template id="report_work_order_document">
    <t t-call="web.html_container">
        <t t-foreach="docs" t-as="o">
            <t t-call="web.external_layout">
                <div class="page">
                    <!-- Header -->
                    <!-- Job Information -->
                    <!-- Customer & Location -->
                    <!-- Technician/Team -->
                    <!-- Description -->
                    <!-- Checklist (if exists) -->
                    <!-- Materials (if esfsm_stock) -->
                    <!-- Timesheets (if esfsm_timesheet) -->
                    <!-- Signatures -->
                    <!-- Footer -->
                </div>
            </t>
        </t>
    </t>
</template>
```

### –£—Å–ª–æ–≤–Ω–∞ –õ–æ–≥–∏–∫–∞

```xml
<!-- –ü—Ä–∏–∫–∞–∂–∏ –º–∞—Ç–µ—Ä–∏—ò–∞–ª–∏ —Å–∞–º–æ –∞–∫–æ –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω esfsm_stock -->
<t t-if="o._has_stock_module() and o.material_ids">
    <div>
        <!-- Materials table -->
    </div>
</t>

<!-- –ü—Ä–∏–∫–∞–∂–∏ –≤—Ä–µ–º–∏—ö–∞ —Å–∞–º–æ –∞–∫–æ –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω esfsm_timesheet -->
<t t-if="o._has_timesheet_module() and o.timesheet_ids">
    <div>
        <!-- Timesheets table -->
    </div>
</t>
```

## –ü—Ä–æ–±–ª–µ–º–∏ –∏ –†–µ—à–µ–Ω–∏—ò–∞

### –ü—Ä–æ–±–ª–µ–º: PDF –Ω–µ —Å–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ wkhtmltopdf –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω:
   ```bash
   docker exec odoo_server which wkhtmltopdf
   ```
2. –ü—Ä–æ–≤–µ—Ä–∏ –ª–æ–≥–æ–≤–∏:
   ```bash
   docker logs odoo_server --tail 100 | grep -i wkhtmltopdf
   ```

### –ü—Ä–æ–±–ª–µ–º: –ü—Ä–∞–∑–µ–Ω PDF –∏–ª–∏ –≥—Ä–µ—à–∫–∞ –≤–æ rendering

**–†–µ—à–µ–Ω–∏–µ:**
1. –¢–µ—Å—Ç–∏—Ä–∞—ò HTML –≤–µ—Ä–∑–∏—ò–∞:
   ```python
   report = env.ref('esfsm_report.action_report_esfsm_work_order')
   html = report._render_qweb_html([job.id])[0]
   # –ü—Ä–æ–≤–µ—Ä–∏ –∑–∞ –≥—Ä–µ—à–∫–∏ –≤–æ HTML
   ```
2. –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ –∏–º–∞ encoding –ø—Ä–æ–±–ª–µ–º–∏ —Å–æ –º–∞–∫–µ–¥–æ–Ω—Å–∫–∏ –∫–∞—Ä–∞–∫—Ç–µ—Ä–∏

### –ü—Ä–æ–±–ª–µ–º: –ü–æ—Ç–ø–∏—Å–∏—Ç–µ –Ω–µ —Å–µ –ø—Ä–∏–∫–∞–∂—É–≤–∞–∞—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ signature –ø–æ–ª–∏—ö–∞—Ç–∞ —Å–µ –ø–æ–ø–æ–ª–Ω–µ—Ç–∏:
   ```python
   job = env['esfsm.job'].browse(123)
   print(f"Technician signature: {bool(job.technician_signature)}")
   print(f"Customer signature: {bool(job.customer_signature)}")
   ```
2. –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ base64 encoding –µ –≤–∞–ª–∏–¥–µ–Ω

### –ü—Ä–æ–±–ª–µ–º: –ú–∞—Ç–µ—Ä–∏—ò–∞–ª–∏/–í—Ä–µ–º–∏—ö–∞ –Ω–µ —Å–µ –ø—Ä–∏–∫–∞–∂—É–≤–∞–∞—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ —Å–æ–æ–¥–≤–µ—Ç–Ω–∏—Ç–µ –º–æ–¥—É–ª–∏ —Å–µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–∏:
  ```python
  job = env['esfsm.job'].browse(123)
  print(f"Has stock: {job._has_stock_module()}")
  print(f"Has timesheet: {job._has_timesheet_module()}")
  ```

## –ü–æ–≤—Ä–∑–∞–Ω–∏ –ú–æ–¥—É–ª–∏

### ESFSM –ï–∫–æ—Å–∏—Å—Ç–µ–º

- **[esfsm](https://github.com/Palifra/esfsm)** - Core Field Service Management
- **[esfsm_project](https://github.com/Palifra/esfsm_project)** - Project Integration
- **[esfsm_stock](https://github.com/Palifra/esfsm_stock)** - Stock & Material Tracking
- **[esfsm_timesheet](https://github.com/Palifra/esfsm_timesheet)** - Timesheet Integration
- **[esfsm_helpdesk]** - Helpdesk Integration (Coming soon)
- **[esfsm_maintenance]** - Equipment Maintenance (Coming soon)

## –†–∞–∑–≤–æ—ò

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –ú–æ–¥—É–ª–æ—Ç

```
esfsm_report/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ __manifest__.py
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ esfsm_job.py
‚îú‚îÄ‚îÄ report/
‚îÇ   ‚îú‚îÄ‚îÄ esfsm_work_order_report.xml
‚îÇ   ‚îî‚îÄ‚îÄ esfsm_work_order_templates.xml
‚îú‚îÄ‚îÄ security/
‚îÇ   ‚îî‚îÄ‚îÄ ir.model.access.csv
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ test_esfsm_report.py
‚îî‚îÄ‚îÄ views/
    ‚îî‚îÄ‚îÄ esfsm_job_views.xml
```

### –î–æ–¥–∞–≤–∞—ö–µ –ù–æ–≤–∏ –°–µ–∫—Ü–∏–∏ –≤–æ –ò–∑–≤–µ—à—Ç–∞—ò–æ—Ç

–ü—Ä–∏–º–µ—Ä: –î–æ–¥–∞–¥–∏ "Equipment" —Å–µ–∫—Ü–∏—ò–∞:

```xml
<!-- –í–æ esfsm_work_order_templates.xml -->
<div t-if="o.equipment_id" style="margin-bottom: 25px;">
    <h5 style="color: #2c3e50; margin-bottom: 10px;">
        <i class="fa fa-cog"/> –û–ø—Ä–µ–º–∞
    </h5>
    <table class="table table-sm">
        <tr>
            <td><strong>–ú–æ–¥–µ–ª:</strong></td>
            <td><span t-field="o.equipment_id.name"/></td>
        </tr>
        <tr>
            <td><strong>–°–µ—Ä–∏—Å–∫–∏ –±—Ä–æ—ò:</strong></td>
            <td><span t-field="o.equipment_id.serial_no"/></td>
        </tr>
    </table>
</div>
```

### –ü—Ä–∏–ª–∞–≥–æ–¥—É–≤–∞—ö–µ –Ω–∞ –°—Ç–∏–ª–æ–≤–∏

```xml
<!-- –î–æ–¥–∞–¥–∏ custom CSS -->
<template id="custom_report_styles" inherit_id="web.report_layout">
    <xpath expr="//head" position="inside">
        <style>
            .custom-header {
                background-color: #your-color;
            }
        </style>
    </xpath>
</template>
```

## –õ–∏—Ü–µ–Ω—Ü–∞

LGPL-3

## –ê–≤—Ç–æ—Ä

**–ï–°–ö–û–ù-–ò–ù–ñ–ï–ù–ï–†–ò–ù–ì –î–û–û–ï–õ –°—Ç—Ä—É–º–∏—Ü–∞**

- **Email:** info@eskon.com.mk
- **Website:** https://www.eskon.com.mk
- **GitHub:** https://github.com/Palifra

## –í–µ—Ä–∑–∏—ò–∞

**18.0.1.0.0** - –û–¥–æ–æ 18 Community Edition

---

**–ü–æ—Å–ª–µ–¥–Ω–æ –∞–∂—É—Ä–∏—Ä–∞–Ω–æ:** 2025-11-23
